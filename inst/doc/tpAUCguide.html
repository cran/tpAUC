<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="author" content="Hanfang Yang, Kun Lu, Xiang Lyu, Feifang Hu, Yichuan Zhao." />

<meta name="date" content="2017-04-08" />

<title>Package tpAUC</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>



<link href="data:text/css;charset=utf-8,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23header%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%20code%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" rel="stylesheet" type="text/css" />

</head>

<body>




<h1 class="title toc-ignore">Package “tpAUC”</h1>
<h4 class="author"><em>Hanfang Yang, Kun Lu, Xiang Lyu, Feifang Hu, Yichuan Zhao.</em></h4>
<h4 class="date"><em>2017-04-08</em></h4>



<p><a id="top"></a></p>
<blockquote>
<p><a href="#basic">Basic Info</a></p>
</blockquote>
<blockquote>
<p><a href="#method">Methodology</a></p>
</blockquote>
<blockquote>
<p><a href="#func">Functions</a></p>
</blockquote>
<blockquote>
<p><a href="#quick">Quick Start</a></p>
</blockquote>
<blockquote>
<p><a href="#ref">Reference</a></p>
</blockquote>
<p><a id="basic"></a></p>
<div id="basic-info" class="section level2">
<h2>Basic Info</h2>
<p>When people evaluate the performance of a diagnostic test, it is important to control both True Positive Rate (TPR) and False Positive Rate (FPR). In the literature, most researchers propose the partial area under the ROC curve (pAUC) with restrictions on FPR to assess a binary classification system, which is named as FPR pAUC. It could be artificially designed to measure the area controlled by TPR, but is often misleading conceptually and practically. A new and intuitive method, named two-way pAUC, is provided in <a href="http://arxiv.org/abs/1508.00298">Yang et al. (2016)</a>, which focuses directly on the partial area under the ROC curve with both horizontal and vertical restrictions. This package solves two-way pAUC estimation based on a non-parametric method in <a href="http://arxiv.org/abs/1508.00298">Yang et al. (2016)</a>. Moreover, estimation and inference of FPR partial AUC and FNR parital ODC are included in this package, utilizing algorithms proposed in <a href="http://www3.stat.sinica.edu.tw/statistica/j27n1/j27n117/j27n117.html">Yang et al. (2017)</a> (see <a href="#method">Methodology</a> for details).</p>
<p><a id="method"></a></p>
</div>
<div id="methodology" class="section level2">
<h2>Methodology</h2>
<div id="estimation" class="section level3">
<h3>Estimation:</h3>
<div id="pauc" class="section level4">
<h4>pAUC:</h4>
<p>The ROC curve is a well-established graphical tool used to evaluate performance of a classifier in accurately discriminating between subjects from different populations (e.g., diseased and healthy individuals). Let <span class="math inline">\(F\)</span> and <span class="math inline">\(G\)</span> be distribution functions of random variables <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> corresponding to independent populations. Let <span class="math inline">\(G^{-1}(t)=\inf \{y: G(y)\geq t\}\)</span> be the quantile function of <span class="math inline">\(G\)</span>, <span class="math inline">\(0&lt; t&lt; 1\)</span>. Let <span class="math inline">\(S_F(t)\)</span> and <span class="math inline">\(S_G(t)\)</span> be the corresponding survival functions <span class="math inline">\(S_F(t)=1-F(t)\)</span> and <span class="math inline">\(S_G(t)=1-G(t)\)</span>. For <span class="math inline">\(t\in (0,1)\)</span>, the ROC curve is defined as <span class="math inline">\(ROC(t) =1-F\{G^{-1}(1-t)\}\)</span> or <span class="math inline">\(ROC(t)=S_{F}\{S_{G}^{-1}(t)\}\)</span>, where <span class="math inline">\(t\)</span> is the value of FPR and <span class="math inline">\(S_G^{-1}(t) = G^{-1}(1-t)\)</span>. The ROC curve is not a convenient tool for comparisions, in particular when two ROC curves cross. A summary measure of an ROC curve can be found by integrating the ROC curve over the the range of FPR values to obtain the area under the ROC curve as <span class="math inline">\(AUC=\int^{1}_{0} ROC(t)\mathrm{d}t =\int^{-\infty}_{\infty}S_{F}(u) \mathrm{d}S_{G}(u)\)</span>. For economical and practical purposes, it is common to hold the FPR to a low level. When interest is restricted to a sub-region of the ROC space, the partial area under the ROC curve, <span class="math inline">\(pAUC(P_0)=\int^{P_0}_{0} ROC(p)\mathrm{d}p\)</span> for the threshold value of FPR <span class="math inline">\(P_0 \in (0,1)\)</span>, can provide a useful summary measure.</p>
<p>Let <span class="math inline">\(\mathbf{X}=\{X_{i}, i= 1,...,m\}\)</span> and <span class="math inline">\(\mathbf{Y}=\{Y_{i}, i= 1,...,n\}\)</span> be random samples from the distribution functions <span class="math inline">\(F(x)\)</span> and <span class="math inline">\(G(y)\)</span>, respectively. A Mann-Whitney nonparamteric method for pAUC is (<code>method='WM'</code>) <span class="math display">\[
\widehat{pAUC}(P_0 ) = \frac{1}{mn}\sum^{m}_{i=1}\sum^{n}_{j=1}I(X_i\ge Y_j)I\{Y_j\ge S^{-1}_{G,n}(P_0)\}, 
\]</span> where <span class="math inline">\(S_{G,n}^{-1}(t)=\inf \left\{x\in R; t\geq S_{G,n}(x)\right\}\)</span> and <span class="math inline">\(S_{F,m}(\cdot)\)</span> and <span class="math inline">\(S_{G,n}(\cdot)\)</span> are estimators of <span class="math inline">\(S_F\)</span> and <span class="math inline">\(S_G\)</span> based on empirical distributions.</p>
<p><a href="http://www.ncbi.nlm.nih.gov/pubmed/20729218">Wang and Chang (2011)</a> propose the following method (<code>method = 'expect'</code>), <span class="math display">\[\widetilde{pAUC}(P_0) = P_{0} - \frac{1}{m} \overset{m}{\underset{i=1}{\sum}} \min \{ S_{G, n}(X_{i}), P_{0}\}.\]</span></p>
<p><a href="http://www3.stat.sinica.edu.tw/statistica/j27n1/j27n117/j27n117.html">Yang et al. (2017)</a> propose a jackknife method (<code>method = 'jackknife'</code>) based on <span class="math inline">\(\widetilde{pAUC}(P_0)\)</span>, in particular, <span class="math display">\[
\widetilde{pAUC}_{jack}(P_0)=\frac{1}{n+m}\sum^{n+m}_{h=1}{V}_h(P_0), 
\]</span> where <span class="math display">\[
{V}_h(P_0)=(n+m)\widetilde{pAUC}(P_0 )-(n+m-1)\widetilde{pAUC}_h(P_0),
\]</span> and <span class="math display">\[
\widetilde{pAUC}_h(P_0)=\left\{\begin{array}{ll}
 P_{0} - \frac{1}{m-1} \sum \limits_{ i \ne h }^m \min \{ S_{G, n}(X_{i}), P_{0}\} &amp; ~\text{ $1 \leq h \leq m$}\\
 P_{0} - \frac{1}{m}  \sum \limits_{ i=1 }^m \min \{ S_{G,n-1, h-m}(X_{i}), P_{0}\} &amp; ~ \text{$m+1 \leq h \leq m+n,$}
\end{array} \right.
\]</span> where <span class="math display">\[S_{G,n-1, h-m}(X_{i})=\frac{1}{n-1} \overset{n}{\underset{j=1, j \neq h-m}{\sum}}I(Y_j&gt;X_{i}). \]</span></p>
</div>
<div id="podc" class="section level4">
<h4>pODC:</h4>
<p>The ordinal dominance curve (ODC) introduced by <a href="http://www.sciencedirect.com/science/article/pii/0022249675900012">Bamber (1973)</a>, describes the association between true negative rate (TNR) and false negative rate (FNR), <span class="math inline">\(ODC(t)= G\{F^{-1}(t)\}\)</span> where <span class="math inline">\(t \in (0,1)\)</span>. The area under the ODC, <span class="math inline">\(\int^{1}_{0} ODC(t)\mathrm{d}t = \int^{\infty}_{-\infty}G(u)\mathrm{d}F(u)\)</span>, is a commonly used summary measure. A partial area under the ODC (pODC) from <span class="math inline">\(0\)</span> to <span class="math inline">\(P_0\)</span> is taken as <span class="math inline">\(pODC(P_0) = \int^{P_0}_{0} ODC(t)\mathrm{d}t\)</span>.</p>
<p>A Mann-Whitney nonparamteric method for pAUC is (<code>method='WM'</code>) <span class="math display">\[\widehat{pODC}(P_0)=\frac{1}{mn}\sum^{m}_{i=1}\sum^{n}_{j=1}I(Y_j\le X_i
 )I\{X_i\le F^{-1}_{m}(P_0)\},\]</span> where <span class="math inline">\(F_{m}^{-1}(P_0)\)</span> is an empirical quantile estimate at <span class="math inline">\(P_0\)</span> and <span class="math inline">\(F_m(\cdot)\)</span> and <span class="math inline">\(G_{n}(\cdot)\)</span> are the empirical distributions of <span class="math inline">\(F(\cdot)\)</span> and <span class="math inline">\(G(\cdot)\)</span>.</p>
<p><a href="http://www3.stat.sinica.edu.tw/statistica/j27n1/j27n117/j27n117.html">Yang et al. (2017)</a> propose the following method (<code>method = 'expect'</code>), <span class="math display">\[\widetilde{pODC}(P_0) = P_{0} - \frac{1}{n} \overset{n}{\underset{j=1}{\sum}} \min \{ F_m(Y_{j}), P_{0}\}.\]</span> <a href="http://www3.stat.sinica.edu.tw/statistica/j27n1/j27n117/j27n117.html">Yang et al. (2017)</a> propose a jackknife method (<code>method = 'jackknife'</code>) based on <span class="math inline">\(\widetilde{pODC}(P_0)\)</span>, in particular, <span class="math display">\[
\widetilde{pODC}_{jack}(P_0)=\frac{1}{n+m}\sum^{n+m}_{h=1}\check{U}_h(P_0), 
\]</span> where <span class="math display">\[
\check{U}_h(P_0)=(n+m)\widetilde{pODC}(P_0)-(n+m-1)\widetilde{pODC}_h(P_0)
\]</span> and <span class="math display">\[
\widetilde{pODC}_h(P_0)=\left\{\begin{array}{ll}
 P_{0} - \frac{1}{n-1} \sum \limits_{j \ne h}^n  \min \{ F_{m}(Y_{j}), P_{0}\} &amp; ~\text{ $1 \leq h \leq n$}\\
 P_{0} - \frac{1}{n} \sum \limits_{j = 1 }^n \min \{F_{m-1, h-n}(Y_{j}), P_{0}\} &amp; ~ \text{$n+1 \leq h \leq m+n,$}
\end{array} \right.
\]</span> where <span class="math display">\[F_{m-1, h-n}(Y_{j})=\frac{1}{m-1} \overset{m}{\underset{i=1, i \neq h-n}{\sum}}I(X_{i} \leq Y_j). \]</span></p>
</div>
<div id="two-way-pauc" class="section level4">
<h4>two-way pAUC:</h4>
<p>The definition and estimation of two-way pAUC are proposed intuitively. Given bounds <span class="math inline">\(p_0\)</span> and <span class="math inline">\(q_0\)</span>, two-way pAUC is formulated as <span class="math display">\[
U(p_0,q_0)  =\int^{p_0}_{S_G\{S^{-1}_F(q_0)\}}S_F\{S^{-1}_{G}(u)\}du-[p_0-S_G\{S^{-1}_F(q_0)\}]q_0 .
\]</span> Alternatively, from a probability perspective, <span class="math inline">\({U}(p_0,q_0)\)</span> can be transformed as: <span class="math display">\[
P\{  \mathbf{Y} &lt; \mathbf{X}, \mathbf{X}\le S_F^{-1}(q_0),  \mathbf{Y}\ge S_G^{-1}(p_0)\}.
\]</span> A trimmed Mann-Whitney U-statistics estimator directly following the above expression is <span class="math display">\[
\frac{1}{mn}\sum^{m}_{i=1}\sum^{n}_{j=1}V_{i,j} (p_0 , q_0),
\]</span> where <span class="math inline">\(V_{i,j} (p_0 , q_0) = I \{ Y_j\le X_i , X_i\le S^{-1}_{F,m}(q_0), Y_j\ge S^{-1}_{G,n}(p_0) \}\)</span>.</p>
<p><a href="#top">Back to Top</a></p>
</div>
</div>
<div id="inference" class="section level3">
<h3>Inference:</h3>
<div id="pauc-1" class="section level4">
<h4>pAUC:</h4>
<p><a href="http://www3.stat.sinica.edu.tw/statistica/j27n1/j27n117/j27n117.html">Yang et al. (2017)</a> prove that, under certain conditions, <span class="math display">\[
\sqrt{m+n}\{\widehat{pAUC}(P_0)-pAUC(P_0)\}\stackrel{d}{\to}N\left\{0,\frac{\sigma^{2}_{1}(P_0)}{\lambda}+\frac{\sigma^{2}_{2}(P_0)}{1-\lambda}\right\},  m,n\to \infty,   \nonumber
\]</span> where <span class="math inline">\(\frac{m}{m+n}\to \lambda\)</span>, <span class="math display">\[
\sigma^2_1(P_0)=\int^{S_G^{-1}(P_0)}_{+\infty}\{P_0-S_G(t)\}^2dS_F(t)-\left\{\int^{S_G^{-1}(P_0)}_{+\infty} S_F(t)dS_G(t)\right\}^2,
\]</span> and <span class="math display">\[
\sigma^2_2(P_0)=\int^{S_G^{-1}(P_0)}_{+\infty}[S_F(t)-S_F\{S_G^{-1}(P_0)\}]^2dS_G(t)-\left(\int^{S_G^{-1}(P_0)}_{+\infty}[S_F(t)-S_F\{S_G^{-1}(P_0)\}]dS_G(t)\right)^2.
\]</span> Moveover, under same conditions, <span class="math display">\[\sqrt{m+n}\{\widetilde{pAUC}_{}(P_0)-pAUC(P_0)\}\stackrel{d}{\to}N\left\{0,\frac{\sigma^{2}_{1}(P_0)}{\lambda}+\frac{\sigma^{2}_{2}(P_0)}{1-\lambda}\right\},  m,n\to \infty.\]</span> and <span class="math display">\[
\sqrt{m+n}\{\widetilde{pAUC}_{jack}(P_0)-pAUC(P_0)\}\stackrel{d}{\to}N\left\{0,\frac{\sigma^{2}_{1}(P_0)}{\lambda}+\frac{\sigma^{2}_{2}(P_0)}{1-\lambda}\right\},  m,n\to \infty.  
\]</span><br />
Consider the jackknife variance estimator <span class="math display">\[S^2_{\widetilde{pAUC}}={(m+n)}^{-1}\sum^{m+n}_{h=1}\{{V}_h(P_0)-\widetilde{pAUC}_{jack}(P_0)\}^2.\]</span> <a href="http://www3.stat.sinica.edu.tw/statistica/j27n1/j27n117/j27n117.html">Yang et al. (2017)</a> prove that <span class="math display">\[
S^2_{\widetilde{pAUC}}(P_0)=\frac{\sigma^{2}_{1}(P_0)}{\lambda}+\frac{\sigma^{2}_{2}(P_0)}{1-\lambda}+o_p(1).
\]</span> Therefore, <span class="math display">\[
\frac{\sqrt{m+n}\{\widetilde{pAUC}_{jack}(P_0)-pAUC(P_0)\}}{\sqrt{S^2_{\widetilde{pAUC}}(P_0)}}\stackrel{d}{\to}N(0,1).
\]</span></p>
</div>
<div id="podc-1" class="section level4">
<h4>pODC:</h4>
<p>In ODC cases, we have <span class="math display">\[
\sqrt{m+n}\{\widehat{pODC}(P_0)-pODC(P_0)\}\stackrel{d}{\to}N\left(0,\frac{\sigma^{2}_{3}}{1-\lambda}+\frac{\sigma^{2}_{4}}{\lambda}\right),  m,n\to \infty,   
\]</span> where <span class="math display">\[
\sigma^2_3=\int^{F^{-1}(P_0)}_{-\infty}\{P_0-F(t)\}^2dG(t)-\left\{\int^{F^{-1}(P_0)}_{-\infty} G(t)dF(t)\right\}^2,
\]</span> and <span class="math display">\[
\sigma^2_4=\int^{F^{-1}(P_0)}_{-\infty}[G(t)-G\{F^{-1}(P_0)\}]^2dF(t)-\left(\int^{F^{-1}(P_0)}_{-\infty}[G(t)-G\{F^{-1}(P_0)\}]dF(t)\right)^2.
\]</span> Similarly, <span class="math display">\[
\sqrt{m+n}\{\widetilde{pODC}_{}(P_0)-pODC(P_0)\}\stackrel{d}{\to}N\left\{0,\frac{\sigma^{2}_{3}(P_0)}{1- \lambda}+\frac{\sigma^{2}_{4}(P_0)}{\lambda}\right\},    
\]</span> and <span class="math display">\[\sqrt{m+n}\{\widetilde{pODC}_{jack}(P_0)-pODC(P_0)\}\stackrel{d}{\to}N\left(0,\frac{\sigma^{2}_{3}}{1- \lambda}+\frac{\sigma^{2}_{4}}{\lambda}\right).\]</span> Together with <span class="math display">\[
\begin{align*}
S^2_{\widetilde{pODC}}&amp; ={(m+n)}^{-1}\sum^{m+n}_{h=1}\{\check{U}_h(P_0)-\widetilde{pODC}_{jack}(P_0)\}^2\\
&amp;=\frac{\sigma^{2}_{3}(P_0)}{1-\lambda}+\frac{\sigma^{2}_{4}(P_0)}{\lambda}+o_p(1).
\end{align*}
\]</span> and <span class="math display">\[
\frac{\sqrt{m+n}\{\widetilde{pODC}_{jack}(P_0)-pODC(P_0)\}}{\sqrt{S^2_{\widetilde{pODC}}(P_0)}}\stackrel{d}{\to}N(0,1).
\]</span></p>
</div>
<div id="two-way-pauc-1" class="section level4">
<h4>two-way pAUC:</h4>
<p>From <a href="http://arxiv.org/abs/1508.00298">Yang et al. (2016)</a>, we have, under certain conditions, <span class="math display">\[
\sqrt{m+n}\{\hat{U}(p_0,q_0)-U(p_0,q_0)\}\stackrel{d}{\to}N\left\{0,\frac{\sigma^2_5}{\lambda}+\frac{\sigma^2_6}{1-\lambda}\right\}, \quad \text{as } \;\; m,n\to \infty,
\]</span> where <span class="math display">\[
\begin{align}
\sigma^2_5= &amp;F\{G^{-1}(1-p_0)\}[G\{F^{-1}(1-q_0)\}-(1-p_0)]^2+\int^{F^{-1}(1-q_0)}_{G^{-1}(1-p_0)}[G\{F^{-1}(1-q_0)\}-G(t)]^2dF(t)\nonumber\\
&amp;-\left\{\int^{F^{-1}(1-q_0)}_{G^{-1}(1-p_0)}F(t)dG(t)\right\}^2\nonumber,
\end{align}
\]</span> and <span class="math display">\[
\begin{align}
\sigma^2_6=&amp;[1-q_0-F\{G^{-1}(1-p_0)\}]^2(1-p_0)\nonumber+ \int^{F^{-1}(1-q_0)}_{G^{-1}(1-p_0)}\{1-q_0-F(t)\}^2dG(t) \\ \nonumber
&amp; -\left\{\int^{F^{-1}(1-q_0)}_{G^{-1}(1-p_0)}G(t)dF(t)\right\}^2\nonumber.
\end{align}
\]</span></p>
<p><a href="#top">Back to Top</a></p>
<p><a id="func"></a></p>
</div>
</div>
</div>
<div id="functions" class="section level2">
<h2>Functions</h2>
<p>This packages contains following functions:</p>
<ol style="list-style-type: decimal">
<li><dl>
<dt><code>tproc.est</code></dt>
<dd>This function estimates two-way parital AUC given response, predictor and pre-specific FPR/TPR constraints via the method in <a href="http://arxiv.org/abs/1508.00298">Yang et al. (2016)</a>.
</dd>
</dl></li>
<li><dl>
<dt><code>proc</code></dt>
<dd>This function estimates and infers FPR parital AUC given response, predictor and pre-specific FPR constraint via method <code>'WM'</code>, <code>'expect'</code> and <code>'jackknife'</code>.
</dd>
</dl></li>
<li><dl>
<dt><code>proc.est</code></dt>
<dd>This function estimates FPR parital AUC given response, predictor and pre-specific FPR constraint via method <code>'WM'</code>, <code>'expect'</code> and <code>'jackknife'</code>.
</dd>
</dl></li>
<li><dl>
<dt><code>proc.ci</code></dt>
<dd>This function infers FPR parital AUC given response, predictor and pre-specific FPR constraint via method <code>'WM'</code>, <code>'expect'</code> and <code>'jackknife'</code>.
</dd>
</dl></li>
<li><dl>
<dt><code>podc</code></dt>
<dd>This function estimates and infers FNR parital ODC given response, predictor and pre-specific FNR constraint via method <code>'WM'</code>, <code>'expect'</code> and <code>'jackknife'</code>.
</dd>
</dl></li>
<li><dl>
<dt><code>podc.est</code></dt>
<dd>This function estimates FNR parital ODC given response, predictor and pre-specific FNR constraint via method <code>'WM'</code>, <code>'expect'</code> and <code>'jackknife'</code>.
</dd>
</dl></li>
<li><dl>
<dt><code>podc.ci</code></dt>
<dd>This function infers FNR parital ODC given response, predictor and pre-specific FNR constraint via method <code>'WM'</code>, <code>'expect'</code> and <code>'jackknife'</code>.
</dd>
</dl></li>
</ol>
<p><a href="#top">Back to Top</a></p>
<p><a id="quick"></a></p>
</div>
<div id="quick-start" class="section level2">
<h2>Quick Start</h2>
<p>The purpose of this section is to show users the basic usage of this package. We will briefly go through main functions, see what they can do and have a look at outputs. An detailed example of complete procedures of estimation and inference will be presented to give users a general sense of the pakcage.</p>
<p>First, we load <code>tpAUC</code> package:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(tpAUC)</code></pre></div>
<p>Then, we estimate two-way partial AUC with date from package <code>pROC</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(<span class="st">'pROC'</span>)
<span class="kw">data</span>(aSAH)
<span class="kw">tproc.est</span>(aSAH$outcome, aSAH$s100b, <span class="dt">threshold=</span><span class="kw">c</span>(<span class="fl">0.8</span>,<span class="fl">0.2</span>) )</code></pre></div>
<pre><code>## Warning in tproc.est(aSAH$outcome, aSAH$s100b, threshold = c(0.8, 0.2)):
## response levels are not 0/1, the first level is defaultly regarded as
## negative.</code></pre>
<pre><code>## [1] 0.4186992</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#estimate two-way partial AUC </span></code></pre></div>
<p><code>tproc.est</code> returns an estimate of two-way partial AUC.</p>
<p>Then, we turn to FPR partial AUC.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">proc.est</span>(aSAH$outcome, aSAH$s100b, <span class="dt">method=</span><span class="st">'expect'</span>,<span class="dt">threshold=</span><span class="fl">0.8</span> )</code></pre></div>
<pre><code>## Warning in proc.est(aSAH$outcome, aSAH$s100b, method = &quot;expect&quot;, threshold
## = 0.8): response levels are not 0/1, the first level is defaultly regarded
## as negative.</code></pre>
<pre><code>## [1] 0.548103</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># use method 'expect' to estimate partial AUC </span>
<span class="kw">proc.ci</span>(aSAH$outcome,aSAH$s100b, <span class="dt">cp=</span><span class="fl">0.95</span> ,<span class="dt">threshold=</span><span class="fl">0.8</span>,<span class="dt">method=</span><span class="st">'expect'</span>)</code></pre></div>
<pre><code>## Warning in proc.ci(aSAH$outcome, aSAH$s100b, cp = 0.95, threshold = 0.8, :
## response levels are not 0/1, the first level is defaultly regarded as
## negative.</code></pre>
<pre><code>## Warning in proc.est(response, predictor, threshold = threshold, method
## = &quot;expect&quot;, : response levels are not 0/1, the first level is defaultly
## regarded as negative.</code></pre>
<pre><code>##          2.5 %    97.5 %
## [1,] 0.4528877 0.6433182</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># use method 'expect' to infer partial AUC</span></code></pre></div>
<p>Alternatively, we can use <code>proc</code> to do both estimation and inference simultaneously.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">proc</span>(aSAH$outcome,aSAH$s100b,<span class="dt">threshold=</span><span class="fl">0.8</span>, <span class="dt">method=</span><span class="st">'expect'</span>,<span class="dt">ci=</span><span class="ot">TRUE</span>, <span class="dt">cp=</span><span class="fl">0.95</span> )</code></pre></div>
<pre><code>## Warning in proc.est(response, predictor, threshold = threshold, method
## = method, : response levels are not 0/1, the first level is defaultly
## regarded as negative.</code></pre>
<pre><code>## Warning in proc.ci(response, predictor, cp = cp, threshold = threshold, :
## response levels are not 0/1, the first level is defaultly regarded as
## negative.</code></pre>
<pre><code>## Warning in proc.est(response, predictor, threshold = threshold, method
## = &quot;expect&quot;, : response levels are not 0/1, the first level is defaultly
## regarded as negative.</code></pre>
<pre><code>## $pauc
## [1] 0.548103
## 
## $ci
##          2.5 %    97.5 %
## [1,] 0.4528877 0.6433182</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># set ci=TRUE to get confidence interval</span></code></pre></div>
<p>Similar procedures on FNR partial ODC are as follows.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">podc.est</span>(aSAH$outcome, aSAH$s100b, <span class="dt">method=</span><span class="st">'expect'</span>,<span class="dt">threshold=</span><span class="fl">0.8</span>)</code></pre></div>
<pre><code>## Warning in podc.est(aSAH$outcome, aSAH$s100b, method = &quot;expect&quot;, threshold
## = 0.8): response levels are not 0/1, the first level is defaultly regarded
## as negative.</code></pre>
<pre><code>## [1] 0.5195122</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># estimate FNR partial ODC with method 'expect'</span>
<span class="kw">podc.ci</span>(aSAH$outcome, aSAH$s100b, <span class="dt">method=</span><span class="st">'expect'</span>,<span class="dt">threshold=</span><span class="fl">0.8</span>, <span class="dt">cp=</span><span class="fl">0.97</span>)</code></pre></div>
<pre><code>## Warning in podc.ci(aSAH$outcome, aSAH$s100b, method = &quot;expect&quot;, threshold
## = 0.8, : response levels are not 0/1, the first level is defaultly regarded
## as negative.</code></pre>
<pre><code>## Warning in podc.est(response, predictor, threshold = threshold, method
## = &quot;expect&quot;, : response levels are not 0/1, the first level is defaultly
## regarded as negative.</code></pre>
<pre><code>##         1.5 %    98.5 %
## [1,] 0.403401 0.6356234</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># infer FNR partial ODC with method 'expect'</span></code></pre></div>
<p><code>podc</code> aggregates the functions of <code>podc.est</code> and <code>podc.ci</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">podc</span>(aSAH$outcome, aSAH$s100b,<span class="dt">threshold=</span><span class="fl">0.8</span>, <span class="dt">method=</span><span class="st">'expect'</span>,<span class="dt">ci=</span><span class="ot">TRUE</span>, <span class="dt">cp=</span><span class="fl">0.97</span>)</code></pre></div>
<pre><code>## Warning in podc.est(response, predictor, threshold = threshold, method
## = method, : response levels are not 0/1, the first level is defaultly
## regarded as negative.</code></pre>
<pre><code>## Warning in podc.ci(response, predictor, cp = cp, threshold = threshold, :
## response levels are not 0/1, the first level is defaultly regarded as
## negative.</code></pre>
<pre><code>## Warning in podc.est(response, predictor, threshold = threshold, method
## = &quot;expect&quot;, : response levels are not 0/1, the first level is defaultly
## regarded as negative.</code></pre>
<pre><code>## $podc
## [1] 0.5195122
## 
## $ci
##         1.5 %    98.5 %
## [1,] 0.403401 0.6356234</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># inference and estimation</span></code></pre></div>
<p><a href="#top">Back to Top</a></p>
<p><a id="ref"></a></p>
</div>
<div id="reference" class="section level2">
<h2>Reference</h2>
<ol style="list-style-type: decimal">
<li>Wang Z, Chang Y C I. <em>Marker selection via maximizing the partial area under the ROC curve of linear risk scores</em>. <strong><em>Biostatistics</em></strong>, 2011, <strong>12(2): 369-385</strong>.</li>
<li>Yang H, Lu K, Lyu X, et al. <em>Two-Way Partial AUC and Its Properties</em>. <strong><em>arXiv:1508.00298</em></strong>, 2016.</li>
<li>Yang H, Lu K, Zhao Y. <em>A nonparametric approach for partial areas under ROC curves and ordinal dominance curves</em>. <strong><em>Statistica Sinica</em></strong>, 2017, <strong>27: 357-371</strong>.</li>
</ol>
</div>



<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
